<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CO2排出量監視システム</title>
    <script src="../static/js/echarts.js"></script>
    <script src="../static/js/visualization.js"></script>
    <script type="text/javascript" src="../static/js/jquery.js"></script>
    <link rel="stylesheet" href="../static/css/comon0.css">

</head>
<body>
    <div class="loading">
        <div class="loadbox"> <img src="../static/images/loading.gif"> Loading.. </div>
    </div>

    <div class="head">
  <h1>CO2排出量監視システム</h1>
  <div class="time" id="showTime">2022/10/01 00:00:00</div>

<script>
var t = null;
    t = setTimeout(time,1000);//開始运行
    function time()
    {
       clearTimeout(t);//清除定时器
       dt = new Date();
		var y=dt.getFullYear();
		var mt=dt.getMonth()+1;
		var day=dt.getDate();
       var h=dt.getHours();//获取时
       var m=dt.getMinutes();//获取分
       var s=dt.getSeconds();//获取秒
		var t = null;
       document.getElementById("showTime").innerHTML = y+"/"+Appendzero(mt)+"/"+Appendzero(day)+" "+Appendzero(h)+":"+Appendzero(m)+":"+Appendzero(s)+"";
        function Appendzero(obj){
			if(obj<10) return "0" +""+ obj;
			else return obj;
		 }
		t = setTimeout(time,1000); //设定定时器，循环运行
    }
</script>
    </div>

    <div class="mainbox">
      <ul class="clearfix">
        <li>
          <div class="boxall" style="height: calc(100% - .15rem)">
            <button id="button1">CO2</button>
            <button id="button2">分</button>
            <div id="alltitle" class="alltitle">1分間CO2排出量ランキング</div>
            <div id="echarts3" class="boxnav" ></div>
          </div>
        </li>
        <li>
          <div class="boxall" style="height: calc(50% - .15rem)">
            <button id="button3">CO2</button>
            <button id="button4">秒</button>          
            <input id="yMaxInput" type="text">
            <button id="updateButton">Update Y Max</button>
            <div id="alltitle2" class="alltitle">リアルタイムCO2排出量(g)</div>
            <div class="boxnav" id="echarts1"></div>
          </div>
          <div class="boxall" style="height: calc(50% - .15rem)">
            <button id="button5">CO2</button>
            <button id="button6">秒</button>
            <div id="alltitle3" class="alltitle">1分間CO2排出累積量(g)</div>
            <div class="boxnav" id="echarts2"></div>
          </div>
        </li>
      </ul>
    </div>
    
    <script>
    // 初始化当前状态
let currentState = [0, 0, 0, 0, 0, 0];
    
    var button1States = ['CO2', '電気'];
    var button2States = ['分', '時', '日', '週'];
    var button3States = ['CO2', '電気'];
    var button4States = ['秒', '分', '時', '日'];
    var button5States = ['CO2', '電気'];
    var button6States = ['秒', '分', '時', '日'];
    var currentButton1State = 0;
    var currentButton2State = 0;
    var currentButton3State = 0;
    var currentButton4State = 0;
    var currentButton5State = 0;
    var currentButton6State = 0;
    var titles = ["1分間CO2排出量ランキング", "1時間CO2排出量ランキング", "1日間CO2排出量ランキング", "1週間CO2排出量ランキング", "1分間電気使用量ランキング", "1時間時間電気使用量ランキング", "1日間電気使用量ランキング", "1週間電気使用量ランキング"]; // replace with your titles
    var titles2 = ["リアルタイムCO2排出量(g)", "分ごとCO2排出量(g)", "時ごとCO2排出量(g)", "日ごとCO2排出量(g)", "リアルタイム電気使用量(kwh)", "分ごと電気使用量(kwh)", "時ごと電気使用量(kwh)", "日ごと電気使用量(kwh)"]; // replace with your titles
    var titles3 = ["1分間CO2排出累積量(g)", "1時間CO2排出累積量(g)", "1日間CO2排出累積量(g)", "1週間CO2排出累積量(g)", "1分間電気使用累積量(kwh)", "1時間電気使用累積量(kwh)", "1日間電気使用累積量(kwh)", "1週間電気使用累積量(kwh)"]; // replace with your titles

    document.getElementById('button1').addEventListener('click', function() {
      currentButton1State = (currentButton1State + 1) % button1States.length;
      button1.innerText = button1States[currentButton1State];
      currentState[0] = currentButton1State;
      updateDisplay();
    });
    
    document.getElementById('button2').addEventListener('click', function() {
      currentButton2State = (currentButton2State + 1) % button2States.length;
      button2.innerText = button2States[currentButton2State];
      currentState[1] = currentButton2State;
      updateDisplay();
    });

    document.getElementById('button3').addEventListener('click', function() {
      currentButton3State = (currentButton3State + 1) % button3States.length;
      button3.innerText = button3States[currentButton3State];
      currentState[2] = currentButton3State;
      updateDisplay();
    });

    document.getElementById('button4').addEventListener('click', function() {
      currentButton4State = (currentButton4State + 1) % button4States.length;
      button4.innerText = button4States[currentButton4State];
      currentState[3] = currentButton4State;
      updateDisplay();
    });

    document.getElementById('button5').addEventListener('click', function() {
      currentButton5State = (currentButton5State + 1) % button5States.length;
      button5.innerText = button5States[currentButton5State];
      currentState[4] = currentButton5State;
      updateDisplay();
    });

    document.getElementById('button6').addEventListener('click', function() {
      currentButton6State = (currentButton6State + 1) % button6States.length;
      button6.innerText = button6States[currentButton6State];
      currentState[5] = currentButton6State;
      updateDisplay();
    });
    
    function updateDisplay() {
      var stateIndex = currentButton1State * button2States.length + currentButton2State;
      var stateIndex2 = currentButton3State * button4States.length + currentButton4State;
      var stateIndex3 = currentButton5State * button6States.length + currentButton6State;
      document.getElementById('alltitle').innerText = titles[stateIndex];
      document.getElementById('alltitle2').innerText = titles2[stateIndex2];
      document.getElementById('alltitle3').innerText = titles3[stateIndex3];
    }
    
    updateDisplay();  // Initialize the display
    </script>

<!-- 模态框结构 -->
<div class="modal" id="settingsModal">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Option</h5>
    </div>
    <div class="modal-body">
      <!-- 模态框内容 -->
      <div class="settings-main">
        <label> <button class="toggle-btn" id="mainToggleBtn"></button> Main: <input type="text" id="mainInput" /></label>
      </div>
      <div class="settings-container">        
        <div class="settings-side settings-left">
          <!-- 左侧输入框 1-8 -->
        </div>
        <img src="../static/images/emporiaVue.jpg" alt="示例图片" class="settings-image" />
        <div class="settings-side settings-right">
          <!-- 右侧输入框 9-16 -->
        </div>
      </div>
      <div class="settings-matome">
        <!-- まとめ输入框 -->
      </div>
    </div>
    <div class="modal-footer">
      <!--<button class="button" id="cancelButton">close</button>-->
      <button class="button" id="saveChanges">save</button>
    </div>
  </div>
</div>

<!-- 保存弹窗部分 -->
<div id="saveModal" class="modal">
  <div class="modal-content save-modal-content">
    <span class="close">&times;</span>
    <h3>Save Data</h3>
    <label for="startDate">Start Date:</label>
    <input type="datetime-local" id="startDate" name="startDate" required>
    <label for="endDate">End Date:</label>
    <input type="datetime-local" id="endDate" name="endDate" required>
    <label for="dataType">Data Type:</label>
    <select id="dataType">
      <option value="second">秒</option>
      <option value="minute">分</option>
      <option value="hour">時</option>
      <option value="day">日</option>
    </select>
    <button id="exportButton">Export</button>
  </div>
</div>

<!-- 弹窗部分 -->
<div id="myModal" class="modal" style="display: none;">
  <div class="modal-content">
    <span class="close">&times;</span>
    <div id="modalChart" style="width: 600px; height: 400px;"></div>
  </div>
</div>

<!-- 弹窗部分 -->
<div id="myModal6" class="modal" style="display: none;">
  <div class="modal-content">
    <span class="close">&times;</span>
    <div id="modalChart6" style="width: 600px; height: 400px;"></div>
  </div>
</div>

<div class="button-container">
  <!-- 设置按钮 -->
  <button id="settingsButton" class="settings-button">Option</button>
  <button id="saveButton" class="settings-button">Save</button>
</div>

<script>
  function echarts_1(data) {
    // 获取当前时间
    var currentTime = new Date();

    var filteredData;
    var timeRange;
    var multiplier;
    var unitMap = {
      0: 'g',
      1: 'kwh',
    };
    var currentStateConfig = {
      0: { duration: 60 * 1000, interval: 3 * 1000 },
      1: { duration: 60 * 60 * 1000, interval: 5 * 60 * 1000 },
      2: { duration: 24 * 60 * 60 * 1000, interval: 3 * 60 * 60 * 1000 },
      3: { duration: 30 * 24 * 60 * 60 * 1000, interval: 48 * 60 * 60 * 1000 }
    };
    
    // 根据currentState选择时间范围和过滤数据的方法
    if (currentState[2] == 0){
      switch(currentState[3]) {
          case 0: // 秒
              timeRange = 60000; // 60000 毫秒 = 1 分钟
              multiplier = 1 / 3600 * 0.433;
              filteredData = data.second;
              break;
          case 1: // 分钟
              timeRange = 3600000; // 3600000 毫秒 = 1 小时
              multiplier = 1 / 60 * 0.433;
              filteredData = data.minute;
              break;
          case 2: // 小时
              timeRange = 86400000; // 86400000 毫秒 = 1 天
              multiplier = 433;
              filteredData = data.hour;
              break;
          case 3: // 天
              timeRange = 2592000000; // 30 天
              multiplier = 433;
              filteredData = data.day;
              break;
      }
    }else if(currentState[2] == 1){
      switch(currentState[3]) {
          case 0: // 秒
              timeRange = 60000; // 60000 毫秒 = 1 分钟
              multiplier = 1 / 3600000;
              filteredData = data.second;
              break;
          case 1: // 分钟
              timeRange = 3600000; // 3600000 毫秒 = 1 小时
              multiplier = 1 / 60000;
              filteredData = data.minute;
              break;
          case 2: // 小时
              timeRange = 86400000; // 86400000 毫秒 = 1 天
              multiplier = 1;
              filteredData = data.hour;
              break;
          case 3: // 天
              timeRange = 2592000000; // 30 天
              multiplier = 1;
              filteredData = data.day;
              break;
      }
    }

    var currentConfig = currentStateConfig[currentState[3]] || currentStateConfig[0];

    // 过滤指定时间范围内的数据
    filteredData = filteredData.filter(function (item) {
      var itemTime = new Date(item.time);
      var timeDifference = currentTime - itemTime;
      return timeDifference <= timeRange;
    });

    // 获取项目名称，排除 "balance"
    var names = filteredData.reduce(function (names, item) {
      if (names.indexOf(item.name) === -1 && item.name !== "Balance") {
        names.push(item.name);
      }
      return names;
    }, []);

    // 过滤掉名为 "balance" 的数据
    filteredData = filteredData.filter(function (item) {
      return item.name !== "Balance";
    });

    // 准备项目数据
    var seriesData = names.map(function (name) {
      var seriesData = filteredData
        .filter(function (item) {
          return item.name === name;
        })
        .map(function (item) {
          return [item.time, item.number * multiplier];
        });

      // 计算开始和结束时间
      var startTime = currentTime - currentConfig.duration;
      var endTime = currentTime;
      var timeStep = currentConfig.interval;

      // 填充缺失的数据
      for (var time = startTime; time < endTime; time += timeStep) {
        var exists = seriesData.some(function (data) {
          return data[0] === time;
        });
        if (!exists && currentState[3] !== 0) {
          seriesData.push([time, null]);
        }
      }

      // 排序数据，确保它们按时间顺序排列
      seriesData.sort(function (a, b) {
        return new Date(a[0]).getTime() - new Date(b[0]).getTime();
      });

      return {
        name: getNewName(name),
        type: 'line',
        data: seriesData,
        connectNulls: false
      };
    });

    // 初始化 ECharts 实例
    var myChart = echarts.init(document.getElementById('echarts1'));

    // 指定图表的配置项和数据
    var option = {
    tooltip: {
      trigger: 'axis',
      axisPointer: {
        type: 'shadow',
      },
    },
    grid: {
      left: '0',
      top: '30',
      right: '10',
      bottom: '0',
      containLabel: true,
    },
    legend: {
      data: names.map(function (name) {
        return getNewName(name);
      }),
      right: 'center',
      top: 0,
      textStyle: {
        color: '#fff',
      },
      itemWidth: 12,
      itemHeight: 10,
    },
    xAxis: {
      type: 'time',
      boundaryGap: false,
      axisLabel: {
        rotate: -90,
        textStyle: {
          color: 'rgba(255,255,255,.6)',
          fontSize: 14,
        },
        interval: function (index, value) {
          return index % (Math.ceil(currentConfig.duration / currentConfig.interval)) === 0;
        },
      },
      axisLine: {
        lineStyle: {
          color: 'rgba(255,255,255,.1)',
        },
      },
      min: currentTime - currentConfig.duration,
      max: currentTime,
      splitNumber: 5,
    },
    yAxis: {
      type: 'value',
      axisTick: { show: false },
      axisLine: {
        lineStyle: {
          color: 'rgba(255,255,255,.1)',
        },
      },
      axisLabel: {
        textStyle: {
          color: 'rgba(255,255,255,.6)',
          fontSize: 14,
        },
        formatter: function (value) {
          var unit = unitMap[currentState[2]] || '';
          return value + unit;
        }
      },
      splitLine: {
        lineStyle: {
          color: 'rgba(255,255,255,.1)',
        },
      },
      max: null
    },
    series: seriesData.map(function (seriesItem, index) {
      // 根据您提供的样式，您可以修改此处的颜色、区域样式、线条样式等。
      // 以下是一个示例，根据项目数量设置不同的颜色。
      var colors = [
        '#3B7DF8', // 蓝色
        '#F44336', // 红色
        '#4CAF50', // 绿色
        '#FF9800', // 橙色
        '#9C27B0', // 紫色
        '#00BCD4', // 青色
        '#FFEB3B', // 黄色
        '#795548', // 棕色
        '#607D8B'  // 蓝灰色
      ];
      var color = colors[index % colors.length];

      return {
        name: seriesItem.name,
        type: 'line',
        smooth: true,
        symbol: 'circle',
        symbolSize: 5,
        showSymbol: false,
        lineStyle: {
          normal: {
            color: color,
            width: 2,
          },
        },
        itemStyle: {
          normal: {
            color: color,
            borderColor: echarts.color.lift(color, 0.1),
            borderWidth: 12,
          },
        },
        data: seriesItem.data,
      };
    }),
    };
    // 使用刚指定的配置项和数据显示图表
    myChart.setOption(option);
    window.addEventListener('resize', function () {
      myChart.resize();
    });

    // 返回一个可以修改Y轴最大值的函数
    return function(yMax) {
      if (yMax === '') { // 如果输入为空，删除最大值设置
        myChart.setOption({yAxis: {max: null}});
      } else { // 否则，更新最大值
        myChart.setOption({yAxis: {max: parseFloat(yMax)}});
      }
    };
  }

  function echarts_2(data) {
    // 获取当前时间
    var currentTime = new Date();

    var filteredData;
    var timeRange;
    var multiplier;
    var unitMap = {
      0: 'g',
      1: 'kwh',
    };
    var currentStateConfig = {
      0: { duration: 60 * 1000, interval: 10 * 1000 },
      1: { duration: 60 * 60 * 1000, interval: 10 * 60 * 1000 },
      2: { duration: 24 * 60 * 60 * 1000, interval: 60 * 60 * 1000 },
      3: { duration: 30 * 24 * 60 * 60 * 1000, interval: 24 * 60 * 60 * 1000 }
    };
    
    // 根据currentState选择时间范围和过滤数据的方法
    if (currentState[4] == 0){
      switch(currentState[5]) {
          case 0: // 秒
              timeRange = 60000; // 60000 毫秒 = 1 分钟
              multiplier = 1 / 3600 * 0.433;
              filteredData = data.second;
              break;
          case 1: // 分钟
              timeRange = 3600000; // 3600000 毫秒 = 1 小时
              multiplier = 1 / 60 * 0.433;
              filteredData = data.minute;
              break;
          case 2: // 小时
              timeRange = 86400000; // 86400000 毫秒 = 1 天
              multiplier = 433;
              filteredData = data.hour;
              break;
          case 3: // 天
              timeRange = 2592000000; // 30 天
              multiplier = 433;
              filteredData = data.day;
              break;
      }
    }else if(currentState[4] == 1){
      switch(currentState[5]) {
          case 0: // 秒
              timeRange = 60000; // 60000 毫秒 = 1 分钟
              multiplier = 1 / 3600000;
              filteredData = data.second;
              break;
          case 1: // 分钟
              timeRange = 3600000; // 3600000 毫秒 = 1 小时
              multiplier = 1 / 60000;
              filteredData = data.minute;
              break;
          case 2: // 小时
              timeRange = 86400000; // 86400000 毫秒 = 1 天
              multiplier = 1;
              filteredData = data.hour;
              break;
          case 3: // 天
              timeRange = 2592000000; // 30 天
              multiplier = 1;
              filteredData = data.day;
              break;
      }
    }

    var currentConfig = currentStateConfig[currentState[5]] || currentStateConfig[0];

    // 过滤指定时间范围内的数据
    filteredData = filteredData.filter(function (item) {
      var itemTime = new Date(item.time);
      var timeDifference = currentTime - itemTime;
      return timeDifference <= timeRange;
    });

    // 获取项目名称，排除 "balance"
    var names = filteredData.reduce(function (names, item) {
      if (names.indexOf(item.name) === -1 && item.name !== "Balance") {
        names.push(item.name);
      }
      return names;
    }, []);

    // 过滤掉名为 "balance" 的数据
    filteredData = filteredData.filter(function (item) {
      return item.name !== "Balance";
    });

    // 准备项目数据
    var seriesData = names.map(function (name) {
      var seriesData = filteredData
        .filter(function (item) {
          return item.name === name;
        })
        .map(function (item) {
          return [item.time, item.number * multiplier];
        });

      // 计算开始和结束时间
      var startTime = currentTime - currentConfig.duration;
      var endTime = currentTime;
      var timeStep = currentConfig.interval;

      // 填充缺失的数据
      for (var time = startTime; time < endTime; time += timeStep) {
        var exists = seriesData.some(function (data) {
          return data[0] === time;
        });
        if (!exists) {
          seriesData.push([time, 0]);
        }
      }

      // 排序数据，确保它们按时间顺序排列
      seriesData.sort(function (a, b) {
        return new Date(a[0]).getTime() - new Date(b[0]).getTime();
      });

        // 累积数据
      for(var i = 1; i < seriesData.length; i++) {
        seriesData[i][1] += seriesData[i-1][1];
      }

      return {
        name: getNewName(name),
        type: 'line',
        data: seriesData,
      };
    });

    // 初始化 ECharts 实例
    var myChart = echarts.init(document.getElementById('echarts2'));

    // 指定图表的配置项和数据
    var option = {
    tooltip: {
      trigger: 'axis',
      axisPointer: {
        type: 'shadow',
      },
    },
    grid: {
      left: '0',
      top: '30',
      right: '10',
      bottom: '0',
      containLabel: true,
    },
    legend: {
      data: names.map(function (name) {
        return getNewName(name);
      }),
      right: 'center',
      top: 0,
      textStyle: {
        color: '#fff',
      },
      itemWidth: 12,
      itemHeight: 10,
    },
    xAxis: {
      type: 'time',
      boundaryGap: false,
      axisLabel: {
        rotate: -90,
        textStyle: {
          color: 'rgba(255,255,255,.6)',
          fontSize: 14,
        },
        interval: function (index, value) {
          return index % (Math.ceil(currentConfig.duration / currentConfig.interval)) === 0;
        },
      },
      axisLine: {
        lineStyle: {
          color: 'rgba(255,255,255,.1)',
        },
      },
      min: currentTime - currentConfig.duration,
      max: currentTime,
      splitNumber: 5,
    },
    yAxis: {
      type: 'value',
      axisTick: { show: false },
      axisLine: {
        lineStyle: {
          color: 'rgba(255,255,255,.1)',
        },
      },
      axisLabel: {
        textStyle: {
          color: 'rgba(255,255,255,.6)',
          fontSize: 14,
        },
        formatter: function (value) {
          var unit = unitMap[currentState[4]] || '';
          return value + unit;
        }
      },
      splitLine: {
        lineStyle: {
          color: 'rgba(255,255,255,.1)',
        },
      },
    },
    series: seriesData.map(function (seriesItem, index) {
      // 根据您提供的样式，您可以修改此处的颜色、区域样式、线条样式等。
      // 以下是一个示例，根据项目数量设置不同的颜色。
      var colors = [
        '#3B7DF8', // 蓝色
        '#F44336', // 红色
        '#4CAF50', // 绿色
        '#FF9800', // 橙色
        '#9C27B0', // 紫色
        '#00BCD4', // 青色
        '#FFEB3B', // 黄色
        '#795548', // 棕色
        '#607D8B'  // 蓝灰色
      ];
      var color = colors[index % colors.length];

      return {
        name: seriesItem.name,
        type: 'line',
        smooth: true,
        symbol: 'circle',
        symbolSize: 5,
        showSymbol: false,
        lineStyle: {
          normal: {
            color: color,
            width: 2,
          },
        },
        itemStyle: {
          normal: {
            color: color,
            borderColor: echarts.color.lift(color, 0.1),
            borderWidth: 12,
          },
        },
        data: seriesItem.data,
      };
    }),
    };
    // 使用刚指定的配置项和数据显示图表
    myChart.setOption(option);
    window.addEventListener('resize', function () {
      myChart.resize();
    });
  }

  function echarts_3(data) {
    // 定义 colors 变量
    var colors = [
        '#3B7DF8', // 蓝色
        '#F44336', // 红色
        '#4CAF50', // 绿色
        '#FF9800', // 橙色
        '#9C27B0', // 紫色
        '#00BCD4', // 青色
        '#FFEB3B', // 黄色
        '#795548', // 棕色
        '#607D8B'  // 蓝灰色
    ];

    // 获取当前时间
    var currentTime = new Date();

    var filteredData;
    var timeRange;
    var multiplier;
    var unitMap = {
      0: 'g',
      1: 'kwh',
    };

    var currentStateConfig = {
      0: { duration: 60 * 1000, interval: 10 * 1000 },
      1: { duration: 60 * 60 * 1000, interval: 10 * 60 * 1000 },
      2: { duration: 24 * 60 * 60 * 1000, interval: 60 * 60 * 1000 },
      3: { duration: 30 * 24 * 60 * 60 * 1000, interval: 24 * 60 * 60 * 1000 }
    };
    
    // 根据currentState选择时间范围和过滤数据的方法
    if (currentState[0] == 0){
      switch(currentState[1]) {
          case 0: // 秒
              timeRange = 60000; // 60000 毫秒 = 1 分钟
              multiplier = 1 / 3600 * 0.433;
              filteredData = data.second;
              break;
          case 1: // 分钟
              timeRange = 3600000; // 3600000 毫秒 = 1 小时
              multiplier = 1 / 60 * 0.433;
              filteredData = data.minute;
              break;
          case 2: // 小时
              timeRange = 86400000; // 86400000 毫秒 = 1 天
              multiplier = 433;
              filteredData = data.hour;
              break;
          case 3: // 天
              timeRange = 2592000000; // 30 天
              multiplier = 433;
              filteredData = data.day;
              break;
      }
    }else if(currentState[0] == 1){
      switch(currentState[1]) {
          case 0: // 秒
              timeRange = 60000; // 60000 毫秒 = 1 分钟
              multiplier = 1 / 3600000;
              filteredData = data.second;
              break;
          case 1: // 分钟
              timeRange = 3600000; // 3600000 毫秒 = 1 小时
              multiplier = 1 / 60000;
              filteredData = data.minute;
              break;
          case 2: // 小时
              timeRange = 86400000; // 86400000 毫秒 = 1 天
              multiplier = 1;
              filteredData = data.hour;
              break;
          case 3: // 天
              timeRange = 2592000000; // 30 天
              multiplier = 1;
              filteredData = data.day;
              break;
      }
    }

    var currentConfig = currentStateConfig[currentState[1]] || currentStateConfig[0];

    // 过滤指定时间范围内的数据
    filteredData = filteredData.filter(function (item) {
      var itemTime = new Date(item.time);
      var timeDifference = currentTime - itemTime;
      return timeDifference <= timeRange;
    });

    // 获取项目名称，排除 "balance"
    var names = filteredData.reduce(function (names, item) {
      if (names.indexOf(item.name) === -1 && item.name !== "Balance") {
        names.push(item.name);
      }
      return names;
    }, []);

    // 过滤掉名为 "balance" 的数据
    filteredData = filteredData.filter(function (item) {
      return item.name !== "Balance";
    });

    // 准备项目数据
    var seriesData = names.map(function (name) {
      var seriesData = filteredData
        .filter(function (item) {
          return item.name === name;
        })
        .map(function (item) {
          return [item.time, item.number * multiplier];
        });

      // 计算开始和结束时间
      var startTime = currentTime - currentConfig.duration;
      var endTime = currentTime;
      var timeStep = currentConfig.interval;

      // 填充缺失的数据
      for (var time = startTime; time < endTime; time += timeStep) {
        var exists = seriesData.some(function (data) {
          return data[0] === time;
        });
        if (!exists) {
          seriesData.push([time, 0]);
        }
      }

      // 排序数据，确保它们按时间顺序排列
      seriesData.sort(function (a, b) {
        return new Date(b[0]).getTime() - new Date(a[0]).getTime();
      });

        // 累积数据
      for(var i = 1; i < seriesData.length; i++) {
        seriesData[i][1] += seriesData[i-1][1];
      }

      return {
        name: getNewName(name),
        number: seriesData[seriesData.length - 1][1],
      };
    });

    seriesData.sort(function(a, b) {
      return b.number - a.number;
    });
    // 只保留 number 最大的 20 个项目
    var topData = seriesData.slice(0, 20);

    // 获取项目名称和 number 数组
    var names = [];
    var numbers = [];
    for (var i = 0; i < topData.length; i++) {
      names.push(topData[i].name);
      numbers.push(topData[i].number);
    }

    // 初始化 ECharts 实例
    var myChart = echarts.init(document.getElementById('echarts3'));

    // 指定图表的配置项和数据
    var option = {
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'shadow'
            }
        },
        grid: {
          left: '0',
          top: '20',
          right: '30',
          bottom: '20',
          containLabel: true,
        },
        xAxis: {
            type: 'value',
            boundaryGap: [0, 0.01],
            axisLabel: {
              formatter: function (value) {
                var unit = unitMap[currentState[0]] || '';
                return value + unit;
              }
            }
        },
        yAxis: {
            type: 'category',
            data: names.reverse(),
            axisPointer: {
            type: 'none', // 设置为 'none' 避免在 Y 轴上显示阴影
            label: {
                show: true,
                backgroundColor: '#6a7985', // 设置高亮背景颜色
                color: '#ffffff' // 设置高亮文字颜色
            }
        }
        },
        series: [
            {
                name: currentState[0] === 0 ? 'CO2排出量(g)' : '电气使用量(kwh)',
                type: 'bar',
                data: numbers.reverse(),
                itemStyle: {
                  emphasis: {
                    color: function (params) {
                      return colors[params.dataIndex];
                    },
                  },
                },
                emphasis: {
                  focus: 'series',
                },
            }
        ]
    };

    // 使用刚指定的配置项和数据显示图表
    myChart.setOption(option);
    window.addEventListener('resize', function () {
      myChart.resize();
    });

    // 弹窗关闭相关代码
    var modal = document.getElementById("myModal");
    var closeButton = document.getElementsByClassName("close")[0];

    closeButton.onclick = function () {
      modal.style.display = "none";
    };

    window.onclick = function (event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    };

    // ECharts 相关代码
    var modalChart = echarts.init(document.getElementById("modalChart"));

    // 在 echarts_3 函数中添加点击事件处理
    option.series[0].emphasis = {
      focus: "series",
    };

    myChart.on('click', function (params) {
      // 在这里，我们定义了四种不同的时间间隔和对应的时间范围
      var timeInterval, duration;
      var timeFormatter;
      switch(currentState[1]) {
          case 0: // 秒
              timeInterval = 1000; // 1000 毫秒 = 1 秒
              duration = 5 * 60; // 5分钟的秒数
              timeFormatter = new Intl.DateTimeFormat('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
              break;
          case 1: // 分钟
              timeInterval = 60 * 1000; // 60 * 1000 毫秒 = 1 分钟
              duration = 5 * 60; // 5分钟的分钟数
              timeFormatter = new Intl.DateTimeFormat('en-US', { hour: '2-digit', minute: '2-digit', hour12: false });
              break;
          case 2: // 小时
              timeInterval = 60 * 60 * 1000; // 60 * 60 * 1000 毫秒 = 1 小时
              duration = 5 * 24; // 5天的小时数
              timeFormatter = new Intl.DateTimeFormat('en-US', { day: '2-digit', hour: '2-digit', hour12: false });
              break;
          case 3: // 天
              timeInterval = 24 * 60 * 60 * 1000; // 24 * 60 * 60 * 1000 毫秒 = 1 天
              duration = 30; // 5个月的天数
              timeFormatter = new Intl.DateTimeFormat('en-US', { month: '2-digit', day: '2-digit' });
              break;
      }

      // 根据 currentState[0] 和 currentState[1] 调整图表标题
      var chartTitle;
      var yAxisUnit1, yAxisUnit2;
      switch(currentState[0]) {
          case 0: 
              chartTitle = 'CO2排出量(';
              yAxisUnit1 = '单位: g';
              break;
          case 1: 
              chartTitle = '电气使用量（';
              yAxisUnit1 = '单位: kwh';
              break;
      }

      switch(currentState[1]) {
          case 0: // 秒
              chartTitle += '秒';
              break;
          case 1: // 分钟
              chartTitle += '分';
              break;
          case 2: // 小时
              chartTitle += '时';
              break;
          case 3: // 天
              chartTitle += '天';
              break;
      }

      chartTitle += ')';
    
      // 获取选中项目的名字
      var selectedItemName = params.name;

      // 筛选与选中项目相关的数据
      var startTime = new Date() - duration * timeInterval; // duration 时间之前的时间戳
      var timeRange = [];

      for (var i = 0; i < duration; i++) {
        timeRange.push(new Date(startTime + i * timeInterval)); // 将每一个时间点的时间戳添加到timeRange数组中
      }
      selectedItemData = timeRange.map(function (time) {
        var existingData = filteredData.find(function (item) {
            var rangeTime = time.getTime();
            var itemTime = new Date(item.time).getTime();
            return getNewName(item.name) === selectedItemName && Math.abs(itemTime  - rangeTime) < timeInterval;
          });

        if (existingData) {
          return existingData;
        } else {
          return { name: selectedItemName, time: time, number: 0 };
        }
      });

      // 准备数据
      var xAxisData = selectedItemData.map(function (item) {
        return timeFormatter.format(new Date(item.time));
      });

      var yAxisData = selectedItemData.map(function (item) {
          return item.number === 0 ? null : item.number * multiplier;
      });

      // 定义 modalOption
      var modalOption = {
        title: {
          text: chartTitle,
          left: 'center'
        },
        tooltip: {
          trigger: 'axis',
        },
        xAxis: {
          type: 'category',
          data: xAxisData,
          
        },
        yAxis: [
          {
            type: 'value',
            axisLabel: {
              formatter: function (value) {
                var unit = unitMap[currentState[0]] || '';
                return value + unit;
              }
            }
          }
        ],
        series: [
          {
            name: yAxisUnit1,
            data: yAxisData,
            type: 'line',
          }
        ]
      };

      // 创建弹出窗口
      var modal = document.createElement('div');
      modal.className = 'modal';
      modal.id = "popup";
      if (document.getElementById("popup")) {
        document.getElementById("popup").remove();
      }
      document.body.appendChild(modal);

      var modalContent = document.createElement('div');
      modalContent.className = 'modal-content';
      modalContent.id = 'modal-content';
      modal.appendChild(modalContent);

      var closeButton = document.createElement('span');
      closeButton.className = 'close';
      closeButton.innerHTML = '&times;';
      modalContent.appendChild(closeButton);

      closeButton.addEventListener('click', function () {
        modal.style.display = 'none';
      });

      // 在弹出窗口中添加图表
      var chartContainer = document.createElement('div');
      chartContainer.style.width = 'calc(100% - 20px)';
      chartContainer.style.height = 'calc(100% - 40px)';
      modalContent.appendChild(chartContainer);

      // 将弹出窗口添加到页面中
      document.body.appendChild(modal);

      // 初始化图表并设置数据
      var newChart = echarts.init(chartContainer);
      setTimeout(function () {
        newChart.setOption(modalOption);
        var modalContent = document.getElementById('modal-content');
        chartContainer.style.width = window.getComputedStyle(modalContent).width + ' - 20px)';
        chartContainer.style.height = 'calc(' + window.getComputedStyle(modalContent).height + ' - 40px)';
        newChart.resize();

        window.addEventListener("resize", function () {
          chartContainer.style.width = window.getComputedStyle(modalContent).width + ' - 20px)';
          chartContainer.style.height = 'calc(' + window.getComputedStyle(modalContent).height + ' - 40px)';
          newChart.resize();
        });
      }, 0);

      // 显示模态窗口
      modal.style.display = 'block';
    });
  }
 
  // ... 其他图表函数
  var updateYMax = echarts_1(data);

  document.getElementById('updateButton').addEventListener('click', function() {
    var yMax = document.getElementById('yMaxInput').value;
    updateYMax(yMax);
  });

  // 更新图表数据的函数
  function updateChartData() {
    // 发起 AJAX 请求以获取新数据
    $.getJSON('/get_saved_data', function (response) {
        var data = response.data;
        fetchData(data).then((datar) => {

          // 使用新数据更新图表
          echarts_1(datar);
          echarts_2(datar);
          echarts_3(datar);

          // 1秒后再次更新数据
          setTimeout(updateChartData, 1000);
        });
    });
  }

  // 页面加载完成时，隐藏 loading 动画
  $(window).load(function() {
      $(".loading").fadeOut();
  });

  // 设置字体大小
  $(document).ready(function() {
      var whei = $(window).width();
      $("html").css({ fontSize: whei / 20 });
      $(window).resize(function() {
          var whei = $(window).width();
          $("html").css({ fontSize: whei / 20 });
      });
  });

// 用于存储新名称数据的全局变量
var newNameData = [];

// 从 JSON 文件中加载新名称数据
function loadNewNameData() {
  $.getJSON("../static/datas/newname.json", function (data) {
    newNameData = data;
    console.log("New name data loaded:", newNameData); // 添加此行以检查数据
  });
}

// 调用函数加载新名称数据
loadNewNameData();

function getNewName(projectName) {
  for (var i = 0; i < newNameData.length; i++) {
    if (newNameData[i].name === projectName) {
      return newNameData[i].newname;
    }
  }
  // 如果找不到对应的新名称，返回原始名称
  return projectName;
}

// 创建输入框
function createInput(id) {
  const input = document.createElement("input");
  input.type = "text";
  input.id = id;
  return input;
}

// 创建按钮的函数
function createToggleButton(id) {
  const button = document.createElement("button");
  button.classList.add("toggle-btn");
  button.id = id;
  return button;
}


// 创建右侧输入框
const rightInputs = document.querySelector(".settings-right");
for (let i = 1; i <= 8; i++) {
  const label = document.createElement("label");
  const toggleBtn = createToggleButton(`toggleBtn${i}`); // 创建按钮
  label.appendChild(toggleBtn); // 将按钮添加到标签中
  const span = document.createElement("span");
  span.textContent = `${i}: `;
  span.style.color = "black"; // 添加这行
  label.appendChild(span);
  const input = createInput(`input${i}`);
  label.appendChild(input);
  rightInputs.appendChild(label);
}

// 创建左侧输入框
const leftInputs = document.querySelector(".settings-left");
for (let i = 16; i >= 9; i--) {
  const label = document.createElement("label");
  const numberSpan = document.createElement("span");
  const toggleBtn = createToggleButton(`toggleBtn${i}`); // 创建按钮
  label.appendChild(toggleBtn); // 将按钮添加到标签中
  numberSpan.textContent = `${i}`;
  numberSpan.classList.add("input-number");
  label.appendChild(numberSpan);
  label.appendChild(document.createTextNode(": "));
  label.style.color = "black"; // 添加这行
  const input = createInput(`input${i}`);
  label.appendChild(input);
  leftInputs.appendChild(label);
}

// 创建まとめ输入框
const matomeContainer = document.querySelector(".settings-matome");
for (let i = 1; i <= 5; i++) {
  const label = document.createElement("label");
  const toggleBtn = createToggleButton(`matomeToggleBtn${i}`); // 创建按钮
  label.appendChild(toggleBtn); // 将按钮添加到标签中
  const span = document.createElement("span");
  span.textContent = `まとめ${i}: `;
  span.style.color = "black"; // 添加这行
  label.appendChild(span);
  const input = createInput(`matomeInput${i}`);
  label.appendChild(input);

  // 追加按钮和对应的名称
  for (let j = 0; j <= 16; j++) {
    const appendBtn = createToggleButton(`appendBtn${i}_${j}`);
    appendBtn.id = `appendBtn${i}_${j}`; // 设置按钮的 id
    label.appendChild(appendBtn);

    const appendSpan = document.createElement("span");
    appendSpan.textContent = j === 0 ? `Main  ` : `${j}  `; // 设置对应的名称
    appendSpan.style.color = "black";
    label.appendChild(appendSpan);
  }

  matomeContainer.appendChild(label);
}

// 读取和保存 newname.json 和 matome.json 的函数
async function fetchJson(url) {
  const response = await fetch(url);
  const data = await response.json();
  return data;
}

async function saveJson(url, data) {
  const response = await fetch(url, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(data),
  });

  return await response.json();
}

// 初始化输入框内容
async function initializeInputs() {
  const newnameData = await fetchJson("../static/datas/newname.json");
  const matomeData = await fetchJson("../static/datas/matome.json");
  const displayData = await fetchJson("../static/datas/display.json");

  // 将名字与新名字匹配
  function getNewName(name) {
    const matchedItem = newnameData.find(item => item.name === name);
    return matchedItem ? matchedItem.newname : "";
  }

  // 将名字与matome名字匹配
  function getMatomeName(name) {
    const matchedItem = matomeData.find(item => item.name === name);
    return matchedItem ? matchedItem.newname : "";
  }

  // 获取按钮初始状态
  // 将名字与按钮状态匹配
  function getButtonStatus(name) {
    const matchedItem = displayData.find(item => item.name === name);
    return matchedItem ? matchedItem.display : "";
  }

  // 初始化按钮状态
  function initializeToggleButtons(buttonData, matomeIndex) {
    for (const key in buttonData) {
      if (key === "1" || key === "2" || key === "3" || key === "4" || key === "5" || key === "6" || key === "7" || key === "8" || key === "9" || key === "10" || key === "11" || key === "12" || key === "13" || key === "14" || key === "15" || key === "16") {
        const button = document.getElementById(`appendBtn${matomeIndex}_${key}`);
        if (buttonData[key] === "1") {
          button.classList.add("pressed");
        } else {
          button.classList.remove("pressed");
        }
      }else if (key === "Main"){
        const button = document.getElementById(`appendBtn${matomeIndex}_0`);
        if (buttonData[key] === "1") {
          button.classList.add("pressed");
        } else {
          button.classList.remove("pressed");
        }
      }
    }
  }

  document.getElementById("mainInput").value = getNewName("Main");
  // 初始化main按钮
  const mainButton = document.getElementById("mainToggleBtn");
  const mainStatus = getButtonStatus("Main");
  mainButton.dataset.status = mainStatus;
  if (mainStatus === "1") {
    mainButton.classList.add("pressed");
  }

  for (let i = 1; i <= 16; i++) {
    document.getElementById(`input${i}`).value = getNewName(i.toString());
    const button = document.getElementById(`toggleBtn${i}`);
    const status = getButtonStatus(i.toString());
    button.dataset.status = status;
    if (status === "1") {
      button.classList.add("pressed");
    }
  }

  for (let i = 1; i <= 5; i++) {
    document.getElementById(`matomeInput${i}`).value = getMatomeName(`matome${i}`);
    const button = document.getElementById(`matomeToggleBtn${i}`);
    const status = getButtonStatus(`matome${i}`);
    if (status === "1") {
      button.classList.add("pressed");
    }
    // 如果i为1（matome1），则始终将其设为按下状态并禁用它
    if (i === 1) {
      button.classList.add("pressed");
      button.disabled = true;
    }
  }

  // 初始化对应的按钮状态
  matomeData.forEach((item, index) => {
    initializeToggleButtons(item, index + 1);
  });
}

initializeInputs();

// 保存按钮点击事件
document.getElementById("saveChanges").addEventListener("click", async function () {
  const newnameData = [];
  const matomeData = [];
  const displayData = [];

  newnameData.push({ name: 'Main', newname: document.getElementById("mainInput").value });
  const mainToggleButton = document.getElementById("mainToggleBtn");
  displayData.push({name: "Main", display: mainToggleButton.classList.contains("pressed") ? "1" : "0"});

  for (let i = 1; i <= 16; i++) {
    newnameData.push({ name: i.toString(), newname: document.getElementById(`input${i}`).value });
    const inputToggleButton = document.getElementById(`toggleBtn${i}`);
    displayData.push({name: i.toString(), display: inputToggleButton.classList.contains("pressed") ? "1" : "0"});
  }

  for (let i = 1; i <= 5; i++) {
    const matomeToggleButton = document.getElementById(`matomeToggleBtn${i}`);
    displayData.push({name: `matome${i}`, display: matomeToggleButton.classList.contains("pressed") ? "1" : "0"});

    const matomeItem = {
      name: `matome${i}`,
      newname: document.getElementById(`matomeInput${i}`).value,
    };
    matomeItem["Main"] = document.getElementById(`appendBtn${i}_0`).classList.contains("pressed") ? "1" : "0";

    for (let j = 1; j <= 16; j++) {
      const inputToggleButton = document.getElementById(`appendBtn${i}_${j}`);
      matomeItem[j.toString()] = inputToggleButton.classList.contains("pressed") ? "1" : "0";
    };

    matomeData.push(matomeItem);
  }

  await saveJson("/update_newname", newnameData);
  await saveJson("/update_matome", matomeData);
  await saveJson("/update_display", displayData);

  // 调用函数加载新名称数据
  loadNewNameData();

  settingsModal.style.display = "none";
});

document.getElementById("settingsButton").addEventListener("click", function () {
  const settingsModal = document.getElementById("settingsModal");
  settingsModal.style.display = "block";
});

// 点击关闭按钮时关闭模态框
document.getElementsByClassName("close")[0].addEventListener("click", function () {
  const settingsModal = document.getElementById("settingsModal");
  settingsModal.style.display = "none";
});

// 点击模态框外部时关闭模态框
window.addEventListener("click", function (event) {
  const settingsModal = document.getElementById("settingsModal");
  if (event.target === settingsModal) {
    settingsModal.style.display = "none";
  }
});

document.querySelectorAll(".toggle-btn").forEach((btn) => {
  btn.addEventListener("click", () => {
    btn.classList.toggle("pressed");
  });
});

async function fetchData(data) {
  const matomeData = await fetchJson("../static/datas/matome.json");
  const displayData = await fetchJson("../static/datas/display.json");

  const processedData = [];

  const dataTypes = ["second", "minute", "hour", "day"];

  for (const dataType of dataTypes) {
    const filteredDataByType = data.filter((item) => item.type === dataType);
    
    for (const item of filteredDataByType) {
      if (item.name === "Main") {
        for (const matomeItem of matomeData) {
          const displayItem = displayData.find((d) => d.name === matomeItem.name);

          if (displayItem && displayItem.display === "0") {
            continue;
          }

          let number = 0;

          if (matomeItem.Main === "1") {
            number += item.number;
          }

          for (let i = 1; i <= 16; i++) {
            if (matomeItem[i.toString()] === "1") {
              const dataItem = filteredDataByType.find(
                (d) =>
                  d.time === item.time &&
                  d.type === item.type &&
                  d.name === i.toString()
              );

              if (dataItem) {
                number += dataItem.number;
              }
            }
          }

          const newItem = {
            type: item.type,
            time: item.time,
            name: matomeItem.newname,
            number,
          };

          processedData.push(newItem);
        }
        // Add the original Main item to the processedData
        processedData.push(item);
      } else {
        const existingItem = processedData.find(
          (p) =>
            p.type === item.type &&
            p.time === item.time &&
            p.name === item.name
        );

        if (!existingItem) {
          processedData.push(item);
        }
      }
    }
  }

  const filteredData = processedData.filter((item) => {
    const displayItem = displayData.find((d) => d.name === item.name);
    return !displayItem || displayItem.display === "1";
  });
  return {
    second: filteredData.filter((item) => item.type === "second"),
    minute: filteredData.filter((item) => item.type === "minute"),
    hour: filteredData.filter((item) => item.type === "hour"),
    day: filteredData.filter((item) => item.type === "day"),
  };
}

// Get the modal
var saveModal = document.getElementById("saveModal");

// Get the button that opens the modal
var saveBtn = document.getElementById("saveButton");

// Get the <span> element that closes the modal
var saveSpan = saveModal.getElementsByClassName("close")[0];

// When the user clicks on the button, open the modal
saveBtn.onclick = function () {
  saveModal.style.display = "block";
};

// When the user clicks on <span> (x), close the modal
saveSpan.onclick = function () {
  saveModal.style.display = "none";
};

// When the user clicks anywhere outside of the modal, close it
window.onclick = function (event) {
  if (event.target == saveModal) {
    saveModal.style.display = "none";
  }
};

async function fetchAllData() {
  try {
    const response = await fetch("/get_all_data");
    const data = await response.json();
    return data.data;
  } catch (error) {
    console.error("Error fetching data:", error);
    return [];
  }
}

function mergeDataByTime(data) {
  const dataByType = {
    second: [],
    minute: [],
    hour: [],
    day: [],
  };

  for (const item of data) {
    const existingItem = dataByType[item.type].find(
      (element) => element.time === item.time
    );

    if (existingItem) {
      existingItem[item.name] = item.number;
    } else {
      dataByType[item.type].push({
        time: item.time,
        [item.name]: item.number,
      });
    }
  }

  return dataByType;
}

async function exportDataToCSV() {
  var startDate = document.getElementById("startDate").value;
  var endDate = document.getElementById("endDate").value;
  var dataType = document.getElementById("dataType").value;

  // 将日期字符串转换为 Date 对象
  startDate = new Date(startDate);
  endDate = new Date(endDate);

  if (!startDate || !endDate || startDate > endDate) {
    alert("Invalid date range");
    return;
  }

  // 获取所有数据
  const allData = await fetchAllData(); // 使用您提供的获取数据的方法
  // 处理数据
  const processedData = await fetchData(allData);

  const allData2 = processedData.second.concat(processedData.minute, processedData.hour, processedData.day);
  const dataByType = mergeDataByTime(allData2);

  // 根据 dataType 获取相应的数据
  const data = dataByType[dataType].filter((item) => {
    const itemTime = new Date(item.time);
    return itemTime >= startDate && itemTime <= endDate;
  });

  // 生成 CSV 字符串
  var csv = "Time";
  var names = Array.from(new Set(allData2.map((item) => item.name)));
  names.forEach((name) => {
    csv += "," + name;
  });
  csv += "\n";

  data.forEach(function (item) {
    csv += item.time;
    names.forEach((name) => {
      if (item[name] !== undefined) {
        switch (dataType) {
          case 'second':
            csv += "," + (item[name] / 3600) * 0.433 + "(g)";
            break;
          case 'minute':
            csv += "," + (item[name] / 60) * 0.433 + "(g)";
            break;
          case 'hour':
            csv += "," + item[name] * 433 + "(g)";
            break;
          case 'day':
            csv += "," + item[name] * 433 + "(g)";
            break;
          default:
            break;
        }
      } else {
        csv += ",";
      }
    });
    csv += "\n";
  });

  // 创建 Blob 对象，设置类型为 Shift_JIS 编码的 CSV
  const blob = new Blob([csv], { type: 'text/csv;charset=UTF-8' });

  // 创建隐藏的可下载链接
  const hiddenElement = document.createElement('a');
  hiddenElement.href = URL.createObjectURL(blob);
  hiddenElement.target = '_blank';
  hiddenElement.download = 'data.csv';
  hiddenElement.click();

  // 释放创建的对象 URL，以避免内存泄漏
  URL.revokeObjectURL(hiddenElement.href);
}

// 为 "Export" 按钮添加事件侦听器
document.getElementById("exportButton").addEventListener("click", exportDataToCSV);

document.querySelector('#saveModal .close').addEventListener('click', () => {
  document.getElementById('saveModal').style.display = 'none';
});

// 初始化图表并第一次更新数据
updateChartData();

</script>

</body>
</html>
